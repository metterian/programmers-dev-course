

## 핵심 개념

- 학습단계 (training or learning phase): 함수 y(x)를 학습데이터에 기반해 결정하는 단계

- Test set: 모델을 평가하기 위해서 사용하는 새로운 데이터

- Generaliztoin: 모델에서 학습에 사용된 데이터가 아닌 이전에 접하지 못한 새로운 데이터에 대해 올바른 에측을 수행하는 역락

- 지도학습: target이 주어진 경우

  - 분류(classification)
  - 회귀(regression)

- 비지도 학습: target이 없는 경우

  - 군집(Clustering)

  



## 다항식 곡선 근사 (Polynomial Curve Fiting)

다음과 같은 곡선을 중심으로 데이터를 예측하는 모델을 구현하고자 한다

![image-20210602141937868](https://i.loli.net/2021/06/02/h7wqEeznJvbKG4R.png)

### 문제 정의

- 학습데이터: 입력벡터 $\mathbf{X}=\left(x_{1}, \ldots, x_{N}\right)^{T}, \mathbf{t}=\left(t_{1}, \ldots, t_{N}\right)^{T}$ 

- 목표: 새로운 입력벡터 $\hat{x}$ 가 주어졌을 때 목표값 $\hat{t}$ 를 예측 하는 것
- 확률이론(Probabilty theory): 예측값의 불확실서을 정량화시켜 표현할 수 있는 수학적인 프레임워크를 제공한다.
- 결정이론(decision theory): 확률적 표현을 바탕으로 최적의 예측을 수행할 수 있는 방법론을 제공한다. 

<br>

### 함수의 근사

이러한 다항식 곡선 문제를 풀기 위해서는 각 데이터를 근사 할 수 있는 적절한 함수를 찾는 것이 중요합니다. 다음 식과 같이 다항식 함수를 사용하여 이를 근사하는 모델을 구성 할 수 있습니다.
$$
y(x, \mathbf{w})=w_{0}+w_{1} x+w_{2} x^{2}+\ldots+w_{M} x^{M}=\sum_{j=0}^{M} w_{j} x^{j}
$$
얼핏보면 위 식은 $x$ 에 대해서 다항식의 형태를 띄고 있습니다. 그렇지만 모델의 파라미터($W$)에 관해서는 선형식(linear)입니다. 이렇게 모델의 입력이 무엇이고 가중치가 무엇인지 구분하는 것이 중요합니다. 여기 가중치($W$)는 고정되어 있고 입력에 대해서 $x$ 가 계속 변하는 것입니다. 우리는 이러한 입력에 대해서 고정된 가중치를 찾아 내는 것이 목표 입니다.

<br>

### 오차 함수(Error Function)

<img src="https://i.loli.net/2021/06/02/4Q8UiRM65KAqb1H.png" alt="image-20210602143614023" style="zoom: 50%;" />

이렇게 모델이 주어져있고 입력이 주어져 있으면 가중치를 찾아야 합니다. 어떻게 찾을 것인가 하는 방법론 중에서는 오차함수를 사용하는 것 입니다. 오차 함수란 입력 값의 데이터와 모델의 값의 차이를 함수 형태로 표현한 것을 나타냅니다. 일반적으로 오차 함수의 가장 대표적인 표현 방법은 제곱합(sum of square)입니다. 
$$
E(\mathbf{w})=\frac{1}{2} \sum_{n=1}^{N}\left\{y\left(x_{n}, \mathbf{w}\right)-t_{n}\right\}^{2}
$$
추가적으로, 위 식은 가중치 $W$ 에 대해서 이차식 형태를 띄고 있습니다. 때문에 가중치 $W$에 대해서 미분을 통해 최소값을 구할 수 있습니다. 

<br>

### 과소적합(Under-fiting)과 과대적합(Over-fiting)

![image-20210602143818546](https://i.loli.net/2021/06/02/He8MXJhDwLSV9Zc.png)

추가적으로, 우리가 구하고자 하는 다음의 식에서 $M$ 의 값을 결정 해줘야 합니다. $M$ 의 값은 가중치의 갯수와 입력 데이터의 차원을 결정하게 됩니다. 
$$
y(x, \mathbf{w})=w_{0}+w_{1} x+w_{2} x^{2}+\ldots+w_{M} x^{M}=\sum_{j=0}^{M} w_{j} x^{j}
$$
데이터의 차원이 커질 수록 입력 데이터에 대해 정확도가 올라가지만, 새로운 데이터에 대해서는 과도한 차원 수로 인해 예측력이 감소 할 수 밖에 없습니다.

<br>

#### 과대적합 여부 판단

위의 예시 처럼 평면상에 데이터를 표현 할 수 있을 때는 과대적합 여부를 쉽게 이해하교 확인 할 수 있지만, 고차원의 데이터의 경우 이를 파악하기가 어렵습니다. 이를 해결하기 위해 오류(Error)를 측정하여 과대 적합 유무를 확인 할 수 있습니다. 다항식 곡선근사에서는 $E_{RMS}$ 스코어를 사용하여 이를 판단 합니다. 
$$
E_{\mathrm{RMS}}=\sqrt{2 E\left(\mathbf{w}^{\star}\right) / N}
$$
<img src="https://i.loli.net/2021/06/02/pWN5fUTJy1we6vs.png" alt="image-20210602151350047" style="zoom: 50%;" />

위 그림을 살펴 보면 $M$ 이 9일 때, 훈련 데이터와 Testing 데이터의 오류의 차이가 심하게 나기 시작합니다. 즉, 훈련데이터에 심하게 과대적합되서 검증데이터에서 결과치가 낮게 나타는 현상입니다. 이렇게 오류 스코어를 통해서 과대적합의 유무를 판단 할 수 있습니다. 

<br>

#### 과대적함의 Pitfall

차원 수를 높여서 과대적합을 이르키는 것이 무조건적으로 안 좋은 것일 까요? 꼭 그렇지만은 않습니다.  다음 그림과 같이 $M=9$  일 때, 데이터 수 $N$ 을 늘려보면 다음과 같습니다. 데이터 수가 늘어 남에 따라 과적합된 모델일지라도 원래의 함수의 모형을 잘 근사하는 모습입니다. 즉, 데이터가 많아 질 수록 좀 더 복잡한(=차원 수가 더 큰)모델을 사용해도 된다는 것 입니다. 

##### M = 9

![image-20210602151912855](https://i.loli.net/2021/06/02/vfjFdSDneGmChzc.png)

<br>

## 규제화 (Regularization)

다음 그림은 $M$의 값으 변화에 따라 가중치(계수)들이 어떻게 변화 하는지를 나타낸 표입니다. 여기서 눈여겨 봐야 할 것은 $M$ 이 커질 수록 가중치의 값도 커진다는 점입니다. 모델이 복잡해 질 수록 이러한 현상을 보정하기 위해 가중치의 절대값 자체가 커지게 되는 것 입니다. 

<img src="https://i.loli.net/2021/06/02/ZEcVFJC4Ub1fa6m.png" alt="image-20210602152227817" style="zoom:50%;" />

<u>이렇게 가중치가 커지면 너무 커지지 않게 가중치(계수)를 제한하면 좋지 않을까?</u> 라는 생각을 하게 됩니다. 이를 규제화라는 방식을 사용해서 이를 구현 할 수 있습니다. 즉, 값이 너무 커지지 않게 식에 값을 제한 할 수있는 장치를 삽입하는 것입니다.

다음 식과 같이, 가중치에 대해 $L2 Norm$을 구한 값에 $\frac{\lambda}{2}$를 스칼라배 해주어 규제화를 하게 됩니다. 즉, $\lambda$ 값을 통해서 가중치를 크게 할 것인지 규제를 할 것인지를 선택할 수 있게 됩니다. 
$$
\begin{array}{l}
\tilde{E}(\mathbf{w})=\frac{1}{2} \sum_{n=1}^{N}\left\{y\left(x_{n}, \mathbf{w}\right)-t_{n}\right\}^{2}+\frac{\lambda}{2}\|\mathbf{w}\|^{2} \\
\\\text { where }\|\mathbf{w}\|^{2} \equiv \mathbf{w}^{\mathrm{T}} \mathbf{w}=w_{0}^{2}+w_{1}^{2}+\ldots+w_{M}^{2}
\end{array}
$$
위 식의 표현은 다음 그림과 같이 나타낼 수 있습니다. $\lambda$ 값이 작아질 수록 규제화의 강도 낮게 되어 우리가 이전에 구한 식과 비슷하게 되고, $\lambda$ 값이 커지게 되면 규제화의 강도가 커지게 되어 차원의 수가 작아지게 됩니다(=모델의 복잡성이 낮아지게 됩니다. )

![image-20210602153004438](https://i.loli.net/2021/06/02/R3dBrtXUnTVY4sz.png)



### $M=9$ 일 때 가중치 값들

$M=9$ 일때의 각 계수를 구하면 다음과 같습니다. $\lambda$ 가 커질수록 규제화의 강도가 커져, 가중치의 값들이 작아지는 모습을 살펴 확인 할 수 있습니다. ``

<img src="https://i.loli.net/2021/06/02/lcEU37zYGyVbgPN.png" alt="image-20210602153413589" style="zoom:50%;" />
